<h3 i18n>System info</h3>

<ng-template #recursiveTree let-data>
  <sh-list [style.padding-left.rem]="data.level * 0.25">
    @for (node of data.children; track node.id) {
      <div
        action
        #treeNode
        [class.cannot-toggle]="node.children.length === 0"
        [class.open]="node.isOpen()"
        (click)="node.children.length > 0 && toggleNode(node)">
        @if (node.children.length > 0) {
          <sh-icon [class.open]="node.isOpen()">caret-down</sh-icon>
        } @else {
          <sh-icon>dot</sh-icon>
        }

        <div class="text">{{ node.text }}</div>
      </div>

      @if (node.isOpen()) {
        <ng-container
          *ngTemplateOutlet="
            recursiveTree;
            context: { $implicit: { children: node.children, level: data.level + 1 } }
          "></ng-container>
      }
    }
  </sh-list>
</ng-template>

<ng-container
  *ngTemplateOutlet="recursiveTree; context: { $implicit: { children: treeStructure(), level: 0 } }"></ng-container>
